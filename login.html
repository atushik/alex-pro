<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"/>
<title>Connexion Coursier - AlexLivraison Pro</title>
<link rel="manifest" href="./manifest-pro.json">
<meta name="theme-color" content="#6b23ff">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="apple-touch-icon" href="logo-pro.jpg">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<style>
  body{font-family:'Segoe UI',sans-serif;background:#f2f2f7;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;margin:0;padding:20px}
  .card{background:#fff;padding:30px;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,0.1);text-align:center;width:100%;max-width:350px}
  input{width:100%;padding:15px;margin:10px 0;border:1px solid #ddd;border-radius:12px;font-size:1.2em;text-align:center;letter-spacing:5px}
  button{width:100%;padding:15px;background:#6b23ff;color:#fff;border:none;border-radius:12px;font-size:1.1em;font-weight:bold;cursor:pointer;margin-top:10px}
  .logo{width:80px;height:80px;border-radius:50%;object-fit:cover;margin-bottom:20px;border:3px solid #6b23ff}
</style>
</head>
<body>
  <div class="card">
    <img src="logo-pro.jpg" class="logo">
    <h2>Espace Coursier</h2>
    <p style="color:#666;margin-bottom:20px">Entrez votre code PIN</p>
    <input type="password" id="pin" placeholder="••••" maxlength="8">
    <button onclick="login()">Se connecter</button>
    <p style="margin-top:20px;font-size:0.9em">Pas encore de compte ? <a href="register.html" style="color:#6b23ff">Devenir coursier</a></p>
    <p style="margin-top:10px;font-size:0.9em"><a href="../index.html" style="color:#888">Retour au site</a></p>
  </div>
<script>
const firebaseConfig={apiKey:"AIzaSyAWagPwv5Skh_EHfdcnFTYeG-xltRM7yPc",authDomain:"alex-livraison.firebaseapp.com",projectId:"alex-livraison",storageBucket:"alex-livraison.firebasestorage.app",messagingSenderId:"937475497279",appId:"1:937475497279:web:62dc9eba8e77a5113ec78a"};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();

if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw-pro.js').catch(console.error);
}

if(localStorage.getItem('alex_courier_logged')) window.location.href = 'dashboard.html';

async function login() {
    const pin = document.getElementById('pin').value;
    if(!pin) return alert("Entrez le code");
    try {
        const snap = await db.collection('couriers').where('password', '==', pin).get();
        if(!snap.empty) {
            const doc = snap.docs[0];
            localStorage.setItem('alex_courier_logged', 'true');
            localStorage.setItem('alex_courier_id', doc.id);
            localStorage.setItem('alex_courier_name', doc.data().fullName);
            window.location.href = 'dashboard.html';
        } else {
            alert("Code incorrect");
        }
    } catch(e) { alert("Erreur de connexion"); }
}
</script>
</body>
</html> 
